(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d94e8de"],{1:function(e,t){},1287:function(e,t,a){"use strict";var n=a("fb10"),l=a.n(n);l.a},2:function(e,t){},3:function(e,t){},"45e8":function(e,t,a){"use strict";var n=a("889e"),l=a.n(n);l.a},"889e":function(e,t,a){},fb10:function(e,t,a){},fff0:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{staticClass:"page-container"},[a("el-row",{staticClass:"page-main sict-upload-file"},[a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[1==e.step?a("el-row",[a("el-col",{staticStyle:{"text-align":"center"}},[a("el-button",{staticStyle:{margin:"20px 0"},attrs:{type:"primary",size:"large",plain:""},on:{click:e.downloadMode}},[e._v("下载excel模板")])],1),e._v(" "),a("upload-excel-component",{staticStyle:{"margin-top":"90px"},attrs:{"on-success":e.handleSuccess,"before-upload":e.beforeUpload}})],1):2==e.step?a("el-row",[a("el-row",{staticStyle:{"text-align":"right",padding:"10px 0px 20px 0px"}},[a("el-button",{on:{click:function(t){e.step=1}}},[e._v("返回上一级")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmImport}},[e._v("下一步")])],1),e._v(" "),a("el-table-self",{attrs:{columns:e.columns,"current-page":e.pageIndex,"list-loading":e.listLoading,"table-data":e.dataList,"total-count":e.total,"page-sizes":e.pageSizes,"page-size":e.pageSize},on:{pageSizeChange:e.handleSizeChange,currentPageChange:e.handleCurrentChange}})],1):3==e.step?a("el-row",[a("upload-imgs")],1):e._e()],1)],1)],1)},l=[],i=(a("c041"),a("40c5"),a("23cc"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("input",{ref:"excel-upload-input",staticClass:"excel-upload-input",attrs:{type:"file",accept:".xlsx, .xls, .csv"},on:{change:e.handleClick}}),e._v(" "),a("div",{staticClass:"drop",on:{drop:e.handleDrop,dragover:e.handleDragover,dragenter:e.handleDragover}},[e._v("\n    拖拽excel文件到此处 或\n    "),a("el-button",{staticStyle:{"margin-left":"16px"},attrs:{loading:e.loading,size:"small",type:"primary"},on:{click:e.handleUpload}},[e._v("\n      点击选择\n    ")])],1)])}),s=[],o=(a("7cfd"),a("75f9")),r=a.n(o),c={props:{beforeUpload:Function,onSuccess:Function},data:function(){return{loading:!1,excelData:{header:null,results:null}}},methods:{generateData:function(e,t){var a=e.header,n=e.results;this.excelData.header=a,this.excelData.results=n,this.onSuccess&&this.onSuccess(this.excelData,t)},handleDrop:function(e){if(e.stopPropagation(),e.preventDefault(),!this.loading){var t=e.dataTransfer.files;if(1===t.length){var a=t[0];if(!this.isExcel(a))return this.$message.error("Only supports upload .xlsx, .xls, .csv suffix files"),!1;this.upload(a),e.stopPropagation(),e.preventDefault()}else this.$message.error("Only support uploading one file!")}},handleDragover:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},handleUpload:function(){this.$refs["excel-upload-input"].click()},handleClick:function(e){var t=e.target.files,a=t[0];a&&this.upload(a)},upload:function(e){if(this.$refs["excel-upload-input"].value=null,this.beforeUpload){var t=this.beforeUpload(e);t&&this.readerData(e)}else this.readerData(e)},readerData:function(e){var t=this;return this.loading=!0,new Promise((function(a,n){var l=new FileReader;l.onload=function(n){var l=n.target.result,i=r.a.read(l,{type:"array"}),s=i.SheetNames[0],o=i.Sheets[s],c=t.getHeaderRow(o),d=r.a.utils.sheet_to_json(o);t.generateData({header:c,results:d},e),t.loading=!1,a()},l.readAsArrayBuffer(e)}))},getHeaderRow:function(e){var t,a=[],n=r.a.utils.decode_range(e["!ref"]),l=n.s.r;for(t=n.s.c;t<=n.e.c;++t){var i=e[r.a.utils.encode_cell({c:t,r:l})],s="UNKNOWN "+t;i&&i.t&&(s=r.a.utils.format_cell(i)),a.push(s)}return a},isExcel:function(e){return/\.(xlsx|xls|csv)$/.test(e.name)}}},d=c,p=(a("1287"),a("4e82")),u=Object(p["a"])(d,i,s,!1,null,"0139a431",null),g=u.exports,f=a("2457"),h=a("e921"),m=a("8b79"),v=a("3f5e"),x=a("ed08"),b={components:{uploadImgs:h["a"],elTableSelf:f["a"],UploadExcelComponent:g},mixins:[m["a"]],data:function(){return{loading:!1,listLoading:!1,step:1,total:0,fileList:[],dataList:[{id:"1",name:"1.png",time:"2019-11-06 11:02:56"},{id:"2",name:"2.png",time:"2019-11-06 11:02:56"},{id:"3",name:"3.png",time:"2019-11-06 11:02:56"},{id:"4",name:"4.png",time:"2019-11-06 11:02:56"},{id:"5",name:"5.png",time:"2019-11-06 11:02:56"},{id:"6",name:"6.png",time:"2019-11-06 11:02:56"},{id:"7",name:"7.png",time:"2019-11-06 11:02:56"},{id:"8",name:"8.png",time:"2019-11-06 11:02:56"},{id:"9",name:"9.png",time:"2019-11-06 11:02:56"},{id:"10",name:"10.png",time:"2019-11-06 11:02:56"}],columns:[{value:"id",label:"编号"},{value:"name",label:"图片名称"},{value:"time",label:"时间"},{label:"操作",align:"center",width:90,hidden:!0,operType:"icon",operations:[{label:"删除",style:"color:red",type:"primary",func:this.deleteRow}]}],templateTable:["患者院内ID","姓名","性别","身份证","家庭住址","手机","紧急联系人姓名","紧急人联系电话","实验室检查时间","胃镜检查时间","出生日期","知情同意","距上次胃镜检查间隔一年内","胃大部手术史","两周内服用PPI或H2受体拮抗剂","有以下症状：6个月内缺铁性贫血，12个月内消化道出血，体重减轻，经常性腹泻，吞咽困难或哽咽感，腹部肿块","有以下疾病史：食管癌，胃癌，结直肠肿瘤，炎症性肠病，其他器官恶性肿瘤","影像、肿瘤标记物等检查高度怀疑罹患肿瘤可能","严重心、肺、肝、肾功能不全或严重精神疾患","是否有直系亲属曾患有胃癌","一级亲属罹患其他恶性肿瘤情况","PGI(ug/l)","PGII(ug/l)","胃泌素-17(pmol/l)","HP抗体","CagA","VacA","尿素酶A","尿素酶B","胃镜检查方式","胃镜精查方式","胃镜诊断","胃镜标准","病理诊断","病理标准","随访计划时间","随访内容"]}},methods:{beforeUpload:function(e){var t=e.size/1024/1024<1;return!!t||(this.$message({message:"Please do not upload files larger than 1m in size.",type:"warning"}),!1)},downloadMode:function(){var e={id:7};Object(v["a"])(e,"blob").then((function(e){Object(x["a"])(e,"模板.xls")}))},handleSuccess:function(e,t){var a=this,n=(e.results,e.header);this.loading=!0;var l=!0;if(this.templateTable.length!==n.length)this.$message.warning("请按照excel模板填写数据！"),this.loading=!1,l=!1;else for(var i=0;i<n.length;i++)if(!this.templateTable.includes(String(n[i].replace(/[\r\n]/g,"").replace(/\ +/g,"")))){l=!1;break}if(l){var s=new FormData;s.append("file",t),Object(v["d"])(s).then((function(e){1===e.code&&(a.$message.success("excel上传成功！"),a.loading=!1,a.step=2,a.total=a.dataList.length)}))}else this.$message.warning("请按照excel模板填写数据！"),this.loading=!1},handleChange:function(e,t){},confirmImport:function(){this.step=3}}},w=b,y=(a("45e8"),Object(p["a"])(w,n,l,!1,null,null,null));t["default"]=y.exports}}]);